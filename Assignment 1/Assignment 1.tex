\documentclass[a4paper, 12pt]{article}
\usepackage{amsmath, amssymb, geometry}
\geometry{margin=2cm}
\title{Optimization in Industry Assignment 1 \\ Mathematical Formulation for Round Robin Match Scheduling}
\author{Utpalraj Kemprai \\ MDS202352}
\date{\today}
\begin{document}
\maketitle

\section*{Sets}
\begin{itemize}
    \item $T$: Set of teams, indexed by $i, j$, where $i, j \in T$.
    \item $D$: Set of days in the tournament, indexed by $d$.
\end{itemize}

\section*{Parameters}
\begin{itemize}
    \item $I_{i,j}$ $(i \neq j)$: Binary parameter, 1 if the match between team $i$ and $j$ is interesting, 0 otherwise
    \item $W_{d}$: Binary parameter, 1 if $d$ is a weekend, 0 otherwise.
    \item $\text{Dist}_{i,j}$: Distance between home stadiums of teams $i$ and $j$.
    \item $E_{d,i}$: Binary parameter, 1 if there is a big event in the city of home stadium of team $i$ on day $d$, 0 otherwise.
    \item $\text{MinGap}, \text{MaxGap}$: Minimum and maximum gap between two consecutive matches for a team.
    \item $\text{MaxConsecHome}$, $\text{MaxConsecAway}$: Integer parameter, maximum number of consecutive home matches and away matches.
    \item $\text{MaxNightMatches}$, $\text{MinNightMatches}$: Integer parameter, maximum and minimum number of night matches to be played by each team.
\end{itemize}

\section*{Decision Variables}
\begin{itemize}
    \item $x_{i,j,d}$ $(i \neq j)$: Binary variable, 1 if match (day or night) is scheduled on day $d$ at home stadium of $i$ between team $i$ amd $j$, 0 otherwise.
    \item $N_{i,j,d}$ $(i \neq j)$: Binary variable 1 if there is a night match between team $i$ and $j$ at home stadium of $i$ in day d, 0 otherwise.
    \item $\text{count}_{i,d}$ : Integer variable to count the number of matches played by team $i$ as of day $d$
    \item $\text{count\_home}_{i,d}$ : Integer variable to count the number of home matches played by team $i$ as of day $d$
    \item $\text{count\_away}_{i,d}$ : Integer variable to count the number of away matches played by team $i$ as of day $d$
    \item $L_{i,j,d}$ $(i \neq j)$: Binary variable 1 if team $j$ is in home location of team $i$ on day $d$.
    
\end{itemize}

\section*{Objective Function}
\begin{align*}
\text{Maximize: } & \sum_{i,j \in T; i \neq j} \sum_{d \in D} I_{i,j} \cdot x_{i,j,d} \cdot W_{d} 
\end{align*}

\section*{Constraints}
\begin{enumerate}
    \item \textbf{Each team plays all others twice (one home and one away):}
    \begin{align*}
        \sum_{d \in D} x_{i,j,d} &= 1 , \forall j \in T \quad \text{($i$ plays $j$ exactly once at home)}\\
        \sum_{d \in D} x_{j,i,d} &= 1 , \forall j \in T \quad \text{($i$ plays $j$ exactly once away)}
    \end{align*}

    \item \textbf{Each team plays at most one match per date}
    \begin{align*}
        \sum_{j \in T; i \neq j} x_{i,j,d} &\leq 1, \forall i \in T \quad \text{($i$ plays atmost one match each day)}
    \end{align*}

    \item \textbf{Only one match in a single day/night slot:}
    \begin{align*}
        \sum_{i,j \in T, i \neq j} x_{i,j,d} (1-N_{i,j,d}) \leq 1, \forall d \in D \\
        \sum_{i,j \in T, i \neq j} x_{i,j,d} N_{i,j,d} \leq 1, \forall d \in D 
    \end{align*}

    \item \textbf{Night Match is not possible if there is no match on that day}
    \begin{align*}
        N_{i,j,d} \leq x_{i,j,d} \quad \forall i,j \in T, d \in D \text{ and } i \neq j
    \end{align*}

    \item \textbf{No overlapping of interesting matches:}
    \begin{align*}
        \sum_{i,j \in T, i \neq j} x_{i,j,d} I_{i,j} N_{i,j,d} &\leq 1 \quad \forall d \in D \\
        \sum_{i,j \in T, i \neq j} x_{i,j,d} I_{i,j} (1 - N_{i,j,d}) &\leq 1 \quad \forall d \in D
    \end{align*}

    \item \textbf{Count of Home and Away matches}
    \begin{align*}
        \text{count\_home}_{i,d} &= \sum_{d' \leq d} \sum_{j \in T; j \neq i} x_{i,j,d'} \\
        \text{count\_away}_{i,d} &= \sum_{d' \leq d} \sum_{j \in T; j \neq i} x_{j,i,d'} \\
        \text{count}_{i,d} &= \text{count\_home}_{i,d} + \text{count\_away}_{i,d}
    \end{align*}

    \item \textbf{Location of the team:}
    \begin{align*}
        L_{i,j,d} &= x_{i,j,d} \quad \forall i,j \in T; i \neq j \text{and} d \in D.
    \end{align*}

    \item \textbf{Bounds on gaps between consecutive matches:}
    \begin{align*}
        \text{count}_{i,d'} - \text{count}_{i,d} &= 0 \quad \forall i \in T \text{ and } \forall d, d' \in D \text{ such that $d' \geq d$ and $d' - d \leq \text{MinGap}$} \\
        \text{count}_{i,d'} - \text{count}_{i,d} &\geq 0 \quad \forall i \in T \text{ and } \forall d, d' \in D \text{ such that $d' \geq d$ and $d' - d \geq \text{MinGap}$} \\
        \text{count}_{i,d+\text{MaxGap}} - \text{count}_{i,d} &\geq 1 \quad \forall i \in T \text{ and } \forall d \in D \setminus \{d \text{ : } d \geq \text{end\_date} - \text{MaxGap} \} 
    \end{align*}

    \item \textbf{Home/away match balance:}
    \begin{align*}
        \text{count\_home}_{i,d} - \text{count\_away}_{i,d} &\leq \text{MaxConsecHome} \\
        \text{count\_away}_{i,d} - \text{count\_home}_{i,d} &\leq \text{MaxConsecAway}
    \end{align*}

    \item \textbf{Avoid matches on restricted days:}
    \begin{align*}
        x_{i,j,d} &\leq 1 - E_{d,i} \quad \forall d \in D, \forall i,j \in T, i \neq j
    \end{align*}

    \item \textbf{Match relocation day for incase of rain:}
    \begin{align*}
        x_{i,j,d} + x_{i,j,d+1} &\leq 1 \quad \forall d \in D \setminus \{ \text{end\_date} \}
    \end{align*}

    \item \textbf{Day and night match balance:}
    \begin{align*}
        \sum_{d \in D} \sum_{j \in T : j \neq i} N_{i,j,d} &\leq \text{MaxNightMatches} \\
        \sum_{d \in D} \sum_{j \in T : j \neq i} N_{i,j,d} &\geq \text{MinNightMatches}
    \end{align*}
\end{enumerate}

\section*{Assumptions}
\begin{itemize}
    \item Interesting matches are known in advanced and depends on which two teams are playing only.
    \item Stadiums are uniformly distributed across zones.
    \item Travel distances between stadiums are known and constant.
    \item Each team has only one home stadium.
    \item MinGap and MaxGap values are set based on league regulations.
    \item MaxConsecHome and MaxConsecAway are set basedon league regulations.
    \item Day and night slots for matches of a day do not overlap with each other.
    \item MaxNightMatches and MinNightMatches are set in advanced based on league regulations.
    \item The days from the start and end date of the round robin are coded as integers i.e. $D = \{1,2,3, \cdots \}$
    \item $\forall d \in D, d+1, \text{ is the immediate next day}$ 
    \item $\text{end\_date}$ is the last date in $D$
\end{itemize}

\end{document}
